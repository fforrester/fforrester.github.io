{% include base_path %}

{% if page.author and site.data.authors[page.author] %}
  {% assign author = site.data.authors[page.author] %}
{% else %}
  {% assign author = site.author %}
{% endif %}

{% assign secondary = site.secondary_links %}

<div itemscope itemtype="http://schema.org/Person">

  <div class="author__avatar">
    {% if author.avatar contains "://" %}
      <img src="{{ author.avatar }}" alt="{{ author.name }}">
    {% else %}
      <img src="{{ author.avatar | prepend: "/images/" | prepend: base_path }}" class="author__avatar" alt="{{ author.name }}">
    {% endif %}
  </div>

  <div class="author__content">
    <h3 class="author__name">{{ author.name }}</h3>
    {% if author.pronouns %}<p class="author__pronouns">{{ author.pronouns }}</p>{% endif %}
    {% if author.bio %}<p class="author__bio">{{ author.bio }}</p>{% endif %}
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      {% if author.location %}
        <li><i class="fa-solid fa-location-dot icon-pad-right" aria-hidden="true"></i>{{ author.location }}</li>
      {% endif %}
      {% if author.employer %}
        <li><i class="fa fa-solid fa-building-columns icon-pad-right" aria-hidden="true"></i>{{ author.employer }}</li>
      {% endif %}
      {% if author.email %}
        <li><a href="mailto:{{ author.email }}"><i class="fas fa-fw fa-envelope icon-pad-right" aria-hidden="true"></i>Email</a></li>
      {% endif %}

      <!-- Main social/academic links -->
      {% for item in author %}
        {% assign platform = item[0] %}
        {% assign handle = item[1] %}
        {% if handle and handle != "" and secondary contains platform == false %}
          <li>
            <a href="{% include social-link-url platform=platform handle=handle %}">
              <i class="fab fa-fw fa-{{ platform }} icon-pad-right"></i>{{ platform | capitalize }}
            </a>
          </li>
        {% endif %}
      {% endfor %}

      <!-- "Other" dropdown -->
      <li>
        <details>
          <summary><i class="fas fa-ellipsis-h icon-pad-right" aria-hidden="true"></i>Other</summary>
          <ul>
            {% for item in author %}
              {% assign platform = item[0] %}
              {% assign handle = item[1] %}
              {% if handle and handle != "" and secondary contains platform %}
                <li>
                  <a href="{% include social-link-url platform=platform handle=handle %}">
                    <i class="fab fa-fw fa-{{ platform }} icon-pad-right"></i>{{ platform | capitalize }}
                  </a>
                </li>
              {% endif %}
            {% endfor %}
          </ul>
        </details>
      </li>
    </ul>
  </div>
</div>
